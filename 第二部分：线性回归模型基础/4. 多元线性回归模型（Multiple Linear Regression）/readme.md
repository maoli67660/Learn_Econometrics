# 📖 第四章 · 多元线性回归模型（Multiple Linear Regression）

---

## 🎯 学习目标

- 理解什么是多元线性回归模型
- 掌握多变量 OLS 的估计方法和含义
- 学会解释回归系数（控制其他变量的影响后）
- 理解多重共线性问题及其影响
- 使用 t 检验和 F 检验进行变量显著性判断
- 掌握调整后的决定系数 \( R^2_{adj} \)
- 初步理解如何扩展模型：交互项、非线性项等

---

## 🔹 4.1 模型形式与基本逻辑

多元回归是回归分析的核心扩展形式，用于解释因变量与多个自变量之间的关系。

### ✅ 一般形式：

```math
Y_i = β₀ + β₁X_{1i} + β₂X_{2i} + ⋯ + β_kX_{ki} + ε_i
```

| 符号 | 含义 |
|------|------|
| \( Y_i \) | 因变量（被解释变量） |
| \( X_{ji} \) | 第 j 个解释变量 |
| \( β_j \) | 第 j 个解释变量的回归系数 |
| \( ε_i \) | 误差项，捕捉未被解释的部分 |

---

## 🔹 4.2 为什么要引入多个变量？

### ✅ 为了解决“遗漏变量偏误”

例如仅用“教育”解释“收入”，可能遗漏“经验”这个重要因素。

> 多元回归允许我们“控制其他变量”，以估计某个变量的“边际效应”。

---

## 🔹 4.3 OLS 估计与含义

多元 OLS 依然最小化残差平方和，数学解为：

```math
β̂ = (X'X)^{-1} X'Y
```

> 实际中，我们使用软件完成计算，更重要的是理解 β̂ 的经济意义。

---

## 🔹 4.4 回归系数解释（控制其他变量之后的边际效应）

例如：

```math
收入 = β₀ + β₁ × 教育 + β₂ × 经验 + ε
```

- \( β₁ \)：教育每增加一年，在经验**不变的前提下**，收入平均增加的数量。
- 所有系数都是“**ceteris paribus（其他条件不变）**”下的影响。

---

## 🔹 4.5 R² 与调整后的 R²

### ✅ R²（决定系数）

```math
R² = 1 - \frac{RSS}{TSS}
```

表示模型对 Y 的解释能力，越接近 1 越好。

### ✅ Adjusted R²（调整后）

```math
R²_{adj} = 1 - \frac{(1 - R²)(n - 1)}{n - k - 1}
```

> 惩罚无意义的变量，仅在新增变量**真正有用时**才会上升。

---

## 🔹 4.6 多重共线性（Multicollinearity）

解释变量之间高度相关 → 会让估计结果不稳定。

### 📌 特征：

- t 检验不显著但 F 检验显著
- 系数变动剧烈
- 标准误变大

### ✅ 检测方法：

- 查看相关系数矩阵
- 计算 VIF 值，若 \( VIF > 10 \) → 共线性严重

### ✅ 应对方法：

- 去掉冗余变量
- 合并变量（如用“综合指数”）
- 使用主成分回归、岭回归等方法（进阶）

---

## 🔹 4.7 显著性检验

### ✅ t 检验（单个变量）：

```math
t = \frac{β̂_j - 0}{SE(β̂_j)}
```

判断某变量在控制其他变量后是否显著。

### ✅ F 检验（多个变量联合）：

- H₀：β₁ = β₂ = ... = 0
- F 值大或 p 值小 → 模型整体显著

---

## 🔹 4.8 为什么默认是“线性”的？

### ✅ 理由如下：

| 原因 | 解释 |
|------|------|
| 易解释 | 教育每多一年，收入平均增加多少 |
| 数学推导清晰 | 有解析解，有显著性检验工具（t/F） |
| 是非线性关系的线性近似 | 很多非线性关系可以被线性模型近似 |
| 是“起点” | 可后续扩展为交互项、对数、非线性项 |

---

## 🔹 4.9 如何扩展模型？（高级回归提示）

### ✅ 加入交互项（interaction term）

```math
收入 = β₀ + β₁ × 教育 + β₂ × 经验 + β₃ × 教育 × 经验 + ε
```

- 用于表示教育的影响因经验而变。

---

### ✅ 加入非线性项（多项式项）

```math
收入 = β₀ + β₁ × 教育 + β₂ × 经验 + β₃ × 经验² + ε
```

- 模拟“经验的边际收益递减”

---

### ✅ 对数模型（log model）

```math
ln(收入) = β₀ + β₁ × 教育 + β₂ × 经验 + ε
```

- 适用于比例增长的解释。

---

## 📝 小节总结（Summary）

| 概念 | 说明 |
|------|------|
| 多元回归 | 估计多个变量对因变量的边际效应 |
| 系数解释 | 控制其他变量后的变化 |
| R²_adj | 防止变量越加越“假好” |
| 多重共线性 | 自变量高度相关，影响估计稳定性 |
| t 检验 | 判断单个变量是否显著 |
| F 检验 | 判断模型是否整体有解释力 |
| 默认线性 | 简洁、直观、便于拓展 |

---

## 📦 Takeaway 知识点携带包

- 多元回归让我们可以控制变量，避免遗漏偏误
- 每个系数表示“其他变量不变时”的边际效应
- 加变量不能只看 R²，要看 R²_adj
- 共线性会让结果“不稳”，注意变量相关性
- 可以加入交互项和非线性项拓展模型，模拟真实世界的复杂关系

---

📌 下一章预告：**模型诊断与残差分析** —— 我们将学习如何识别模型中的异方差性、自相关问题，以及如何做稳健回归！

